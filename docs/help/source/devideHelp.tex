% NOTES: tex2rtf doesn't like mixed case and such

\documentstyle[a4,makeidx,verbatim,texhelp,fancyhea,mysober,mytitle]{report}%
%\input{psbox.tex}
\newcommand{\commandref}[2]{\helpref{{\tt $\backslash$#1}}{#2}}%
\newcommand{\commandrefn}[2]{\helprefn{{\tt $\backslash$#1}}{#2}\index{#1}}%
\newcommand{\commandpageref}[2]{\latexignore{\helprefn{{\tt $\backslash$#1}}{#2}}\latexonly{{\tt $\backslash$#1} {\it page \pageref{#2}}}\index{#1}}%
\newcommand{\indexit}[1]{#1\index{#1}}%
\newcommand{\inioption}[1]{{\bf {\tt #1}}\index{#1}}%
\parskip=10pt%
\parindent=0pt%
%\backgroundcolour{255;255;255}\textcolour{0;0;0}% Has an effect in HTML only
\winhelpignore{\title{DeVIDE Help}

\author{Charl P. Botha}%
}%
\winhelponly{\title{DeVIDE Help}

\author{Charl P. Botha}%
}%
\makeindex%
\begin{document}%
\maketitle%
\pagestyle{fancyplain}%
\bibliographystyle{plain}%
\pagenumbering{roman}%
\setheader{{\it CONTENTS}}{}{}{}{}{{\it CONTENTS}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%
\tableofcontents%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter*{Copyright notice}%
\setheader{{\it COPYRIGHT}}{}{}{}{}{{\it COPYRIGHT}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%
DeVIDE is copyright (c) 2004 by Charl P. Botha <cpbotha@ieee.org>

This software is licensed exclusively for research use by authorised
parties.  All unauthorised use or distribution is strictly prohibited.

Any modifications made to this software, with exception of work in the
userModules/ tree, shall be sent to the author for possible inclusion
in future versions.  Ownership and copyright of said modifications
shall be unconditionally ceded to the author.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHORS OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Introduction}%
\pagenumbering{arabic}%
\setheader{{\it CHAPTER \thechapter}}{}{}{}{}{{\it CHAPTER \thechapter}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%
This is the user manual and help file for the DeVIDE software package.
DeVIDE is the Delft Visualisation and Image processing Development
Environment.

The software was designed for the rapid prototyping and testing of
visualisation and image processing techniques.  All functionality is
packaged in the form of modules.  One of the ways in which these
modules can be used, is to make use of the DeVIDE Graph Editor, where
glyphs, representing modules, can be connected up to form functional
data-processing networks.  A key feature is that any code object can
be accessed and interacted with in real-time.  This enables both
module writers and users of the Graph Editor to experiment with for
example all parameters and even the logic behind a running piece of
functionality.

DeVIDE is available for the Windows and Linux platforms.  As soon as
anybody donates an Apple G4 Powerbook, I will make available packages
for that platform as well.

This manual is in a very early stage of development. :)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Graph Editor}
\pagenumbering{arabic}%
\setheader{{\it CHAPTER \thechapter}}{}{}{}{}{{\it CHAPTER \thechapter}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%

The DeVIDE Graph Editor is a visual programming interface where glyphs
representing the underlying DeVIDE modules can be connected together
to form new programs.  It's the most flexible way of working with
DeVIDE, short of directly interfacing with the underlying code.

This chapter will give a brief overview of graph editor usage.

\section{A few important tips}
Before we start, a few productivity-enhancing secrets of the Graph
Editor are revealed here.

\subsection{Getting module-specific help}
Many modules have module-specific help-text built in.  To see this
help-text, create the relevant module-glyph on the canvas, right click
on the module, and select ``Help on Module''.

Also remember that selected (special) modules are documented in the
chapter \helpref{Special Modules}{secSpecialModules}.

\subsection{Reading data, quickly}
Dragging and dropping certain data-files on the Graph Editor canvas
will cause the system to automatically create and configure the
applicable module.  For example: selecting, dragging and dropping a
collection of DICOM .dcm files on the canvas will result in a dicomRDR
glyph to be created and pre-configured with the list of files that has
been dropped.

\subsection{Re-using networks, quickly}
Dragging and dropping a .dvn (DeVIDE Network) file on the canvas will
instantly load the network and build it at the mouse position.  This
will not destroy any of your current networks on the canvas.

\subsection{Quick-type module find}
Select the module categories that you want to work with.  Now focus
the canvas by clicking on it with your mouse.  Modules can now be
quickly selected by typing the first few letters in their names.  Once
the module you want is highlighted, press the ``Enter'' key to place
it.

\section{A small sample network}
The Graph Editor is introduced by putting together a simple network for
rendering the 3D 0-surface of a Super Quadric.  It's far simpler than
it sounds.

\subsection{Constructing the network}
Start by building the network shown in figure \ref{figGFN}.  First
select the ``Sources'' category on the top left of the Graph Editor.
Drag and drop the ``superQuadric'' module from the modules list on the
bottom left to the canvas.  You should see the ``superQuadric'' glyph
being created.

\begin{figure}
$$\image{5cm;0cm}{figures/gefirstnetwork}$$
\caption{Your first DeVIDE network.}\label{figGFN}
\end{figure}

Now do the same for the ``slice3dVWR'' module in the ``Viewers''
category.  Note that you can select multiple categories by holding the
Shift key and clicking a category (this will select all categories between the
previous selected category and your current click) or holding the
control key and clicking (this will select the currently clicked
module along with any previously selected modules).  The module list
will contain all modules in all selected categories.  The modules are
always alphabetically sorted.

Connect the second output of the ``superQuadric'' glyph to any input
of the ``slice3dVWR'' glyph by dragging the mouse, with the left
button depressed, from the output port to the input port.  Note that
hovering the mouse pointer over any port shows more information about
that port in the status bar of the Graph Editor.

\subsection{Admiring your results}
Right-click on the slice3dVWR module and select ``View-Configure'' to
see the 3D surface representing the 0-surface of the generated Super
Quadric.  Note that this is how one activates the graphical interface
of any glyph on the canvas.  You can rotate your viewpoint around the
generated 3D object by dragging with your left mouse button.  Dragging
with the right button will zoom.  Dragging with the middle button will
pan the viewpoint.

The network can be saved by selecting ``Save'' from the ``File''
menu.  The default extension for a DeVIDE network is .dvn.

\subsection{Warping the Super Quadric}
The slice3dVWR is a very special DeVIDE module.  Because of this, its
View/Config interface is non-standard.  Right click on the
``superQuadric'' glyph and select ``View-Config'' to see a more
standard user interface.  This interface is shown in figure
\ref{figSuperQuadricView}.

\begin{figure}
$$\image{5cm;0cm}{figures/superquadricview}$$
\caption{The superQuadric View/Config window.}\label{figSuperQuadricView}
\end{figure}

Most module View/Config windows have the set of buttons at the
bottom.  If you make any changes to any of the module parameters, you
have to click on the ``Apply'' button (in which case the parameters
will be transferred to the underlying logic) or the ``Execute''
button, (in which case the new parameters will be transferred to the
underlying logic and the module will be asked to re-perform its
executing with the modified paramaters).  Clicking on the ``Sync''
button will transfer all parameters from the underlying logic to the
GUI.  In other words, if you've made changes to the parameters but you
would like to revert them, and you haven't applied them yet, click on
the ``Sync'' button to revert.

Change the ``Phi Roundness'' parameter to $3.0$ and click on
``Execute'' or simple press the Enter key.  Pressing ``Enter'' is
effectively the same as clicking on ``Execute''.  See the results of
your changes in the slice3dVWR window.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Special modules}\label{secSpecialModules}
\pagenumbering{arabic}%
\setheader{{\it CHAPTER \thechapter}}{}{}{}{}{{\it CHAPTER \thechapter}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%

This chapter has more documentation on some of the more complex
modules in DeVIDE.  Remember that all modules have module-specific
documentation, available by right clicking on the module glyph and
selecting ``Help on Module'' or by querying the doc-string of the main
module class.

\section{The slice3dVWR}\label{secslice3dVWR}

\subsection{Slices}\label{secSlices}
When a volume has been connected to an input of the slice3dVWR, the
volume can be examined by ``slicing'' through it.  By default, an
axial slice is created automatically, but any number of additional
slices can be activated.

\subsubsection{Overlay modes}
The slice3dVWR has several overlay modes.  These modes make it
possible to visualise the correspondence between multiple inputs, for
e.g. original CT data and a segmentation.  If a second volume input is
connected, the slice3dVWR checks if the dimensions of the already
connected volume.  If this is the case, the connection is allowed and
the second volume is overlayed (superimposed) on the first.

There are several ways to perform this overlay.  This setting is
user-configurable and its user interface can be found on the ``Main''
tab of the slice3dVWR ``Controls'' window, in the ``Slices'' section.
The user interface consists of an Overlay Mode choice box and an Alpha
slider.  The alpha slider determines the alpha parameter used for the
fusion-based overlay modes.

\begin{itemize}
\item {\bf Green Fusion:} The overlay is composited with the
  user-defined alpha parameter.  The value (i.e. brightness) is
  directly related to the image intensity of the overlay, so we see
  shades of green (reflecting the overlay intensity) alpha blended with
  the primary input.
\item {\bf Red Fusion:} Same as above, except with shades of red.
\item {\bf Blue Fusion:} Same as above, except with shades of blue.
\item {\bf Hue Fusion:} The value is kept constant, but the hue is
  directly related to the overlay image intensity.  The overlay is
  alpha blended with the user-supplied alpha parameter.
\item {\bf Hue/Value Fusion:} Hue {\em and} brightness are directly
  related to the overlay image intensity.  The overlay is
  alpha-blended with the user-supplied alpha parameter.
\item {\bf Green Opacity Range:} The opacity of the overlay is
  directly related to its image intensity.  The hue is constant green
  and the brightness is constant unity.
\item {\bf Blue Opacity Range:} The same as above, except the hue is
  constant red.
\item {\bf Blue Opacity Range:} The same as above, except the hue is
  constant blue.
\item {\bf Hue Opacity Range:} The hue and the opacity of the overlay
  are directly related to the overlay image intensity.
\end{itemize}

Adjusting the alpha slider whilst one of the ``fusion'' overlay modes
is active will result in real-time changes.  The idea is to adjust it
up and down its complete range in order to get a better idea of the
amount of the image correspondence.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Useful patterns}
This chapter contains a selection of howtos, i.e. very short
descriptions of how to perform some action with the DeVIDE software.

\section{Loading and viewing DICOM data}
The easiest way to load a DICOM dataset is to select the relevant
DICOM files (often with a .dcm extension) in your file browser
(e.g. Explorer in Windows and Konqueror in KDE) and to drag and drop
the selected files on the Graph Editor Canvas.  A ``dicomRDR'' module
will be automatically created with the selected filenames added.

Alternatively, you can create a ``dicomRDR'' module in the normal way,
i.e. by dragging and dropping the module from the Module Palette onto
the canvas.  Double click on the module to open its View/Config
window.  Click on the ``Add'' button to add any number of DICOM
filenames.  Remember to click on ``Apply'' after having added the
relevant filenames.

A DICOM dataset (or study) can consist of a number of series, where
each series is a coherent volume and consists of a number of stacked
images.  The ``dicomRDR'' module will automatically sort and group the
different series after the ``Apply'' button has been clicked.  A
different series can be chosen by modifying the ``Series Instance
Index'' input in the ``dicomRDR'' View/Config window and clicking on
the ``Apply'' button again.  At this time, the other information in
the window, such as the study description and the dimensions, will be
updated to reflect the new series.

To start visualising the volume that you have just loaded, create a
``slice3dVWR'' module and then connect the output of the ``dicomRDR''
module to any input of the ``slice3dVWR'' module.  The module
interface will automatically appear with the default axial slice.  To
read more about interacting with this slice, see the \helpref{slices
section}{secSlices} of the \helpref{slice3dVWR
documentation}{secslice3dVWR}.

\section{Smoothing data}
There are a number of filters in DeVIDE that can be used for smoothing
volume data.

Filters.imageGaussianSmooth performs a straight-forward Gaussian
smoothing (also known as ``blurring'' in some image processing
packages).  The standard deviation (in pixels) can be set for all
three dimensions.  A truncation, or cut-off, can also be set for all
three dimensions.  Take into account the resolution of your image when
selecting these paramaters.

curvatureFlowDenoising, curvatureAnisotropicDiffusion and
gradientAnisotropicDiffusion, all in the ``Insight'' module category,
are more advanced smoothing algorithms that attempt to smooth
homogeneous regions whilst retaining edge information.  These are all
compute-intensive ITK-based filters.  Please read the tooltips
available in the configuration windows: i.e. double click on the
module and then let your mouse hover over any of the input boxes to
get more information about the variable required for that input box.
The defaults are naturally good values to start with.

When you use these with VTK data, for example the output of a vtiRDR,
you have to use a VTKtoITKF3 conversion module.  To visualisation the
output, you need to convert back to VTK data by making use of an
ITKF3toVTK module.  However, if you're planning to use the output in
an ITK filter, for example the demonsRegistration, you don't need an
ITKF3toVTK conversion module at the output.  Figure \ref{figCADvis}
shows an example of this.

\begin{figure}
$$\image{5cm;0cm}{figures/curvatureAnisotropicDiffusionVis}$$
\caption{Example network with curvatureAnisotropicDiffusion module
showing the use of ITK/VTK conversion modules.}\label{figCADvis}
\end{figure}

\section{Probing and warping (interactive advection)}
Figure \ref{figPAW} shows how to perform interactive probing and
warping (advection) with DeVIDE.

\begin{figure}
$$\image{5cm;0cm}{figures/probingAndWarping}$$
\caption{Probing and warping (advecting) with DeVIDE.}\label{figPAW}
\end{figure}

The volume data has been loaded with vtkRDR dvm11 and serves as
context in the slice3dVWR.  In this case, we are using two vector
fields, loaded with respectively metaImageRDR dvm7 and dvm11fyi11.
Points that have been selected and stored with the slice3dVWR (these
can be changed at any time, the network updates interactively) are
changed into spherical shells of points by the pointsToSpheres module
dvm6ldz6.  The output of this module can be connected to the
slice3dVWR to view the initial sphere.

The first probeFilter dvm7fxg7 maps and interpolates the vectors from
the first vector field onto the points of the spherical cloud.
Connect the output of the probeFilter to the warpPoints module.  After
connecting the warpPoints input, make sure to ``Execute'' and
``Apply'' the warpPoints module once.  The correct ``Vectors
selection'' can then be made from its View/Config window.  (Thijs en
Ronald, in jullie geval moet dit ``ImageFile'' zijn!).  After having
made this selection, ``Apply'' or ``Execute'' the module again.  Now
you can connect its output to the slice3dVWR.  The points are advected
by the vectors that you have associated to them.

This output is also used in the next advection step, using the next
vector field.  Once again, make sure to select the correct vectors in
the warpPoints module View/Config window.  You could also simply copy
and paste the first probeFilter and warpPoints module (AFTER you've
performed the vector selection step), in which case the selection will
already be correct.

Add as many of these steps as are necessary to complete the full
advection with all your available vector fields.  At each step, check
that your sphere is being correctly advected before you continue.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Creating new modules}
TBD.

%\bibliography{refs}
%\addcontentsline{toc}{chapter}{Bibliography}
%\setheader{{\it REFERENCES}}{}{}{}{}{{\it REFERENCES}}%
%\setfooter{\thepage}{}{}{}{}{\thepage}%

\addcontentsline{toc}{chapter}{Index}
\setheader{{\it INDEX}}{}{}{}{}{{\it INDEX}}%
\setfooter{\thepage}{}{}{}{}{\thepage}%
\printindex%

\end{document}
